---
layout: post
title: 申请amazon ec2 – 首年免费的vps
tags: 未分类
date: 2011-11-23 23:48:33
---

打开sbt运行ebb，下载各jar花了四个小时还没搞定，F**K方校长也没用，只能想想别的方法了。开始想买个便宜点的国外vps，在上面运行sbt，把jar下载好之后，再通过ftp取回来。虽然麻烦，但好在不会干等。一旦搜索之后，舍不得：最便宜的也要每个月35块，好点的上百。于是我在群里号召大家一起凑点钱买个共用的，可惜响应人数不多，只好做罢。

好在教主告诉我，amazon有一个ec2，首年免费，配置不错，让我申请一个。一搜索之下，果然发现天下竟有如此的好事：amazon ec2的micro型vps，内存612M，硬盘忘了，申请成功后马上能开通，SSH登录，拥有root操作权限，想装啥就装啥。

<span id="more-586"></span>
<p>马上动手申请，地址如下：[http://aws.amazon.com/ec2/](http://aws.amazon.com/ec2/)

**一、申请**

虽然是英文的，但申请过程不难，要填写一些资料。有两点需要注意：

1.  要有一张能支持美元的信息卡，如MasterCard
2.  有一个固话来输入验证码（一定要是固话）

关于这个micro ec2，有三点要注意：

1.  没有IP，想要独立IP得另付费。只能通过它提供的一个三级域名访问，叫Public DNS什么。这样就没法用它做免费的网站服务器了。
2.  一年之后，某些服务需付费，但是是按使用量付费。
3.  instance stop后，它的public dns会变，需要更新

我卡在了电话验证码上。我输入了手机号，点击“Call Me”后接到一个越洋电话。只听得一女声说着不清不楚的英语，提示我输入那4位验证码。不论怎么输入，都提示我“not match“。三次之后，提示我12个小时后才能再次验证。第二天晚上、第三天晚上各试了一遍，还是没成功。经过一翻搜索，终于看到有人说他用手机通不过，改用固话就过了。

现在固话越来越难找，今天晚上我让我一朋友用公司的固话帮我输入，总算成功。

**二、创建实例**

进去后，打开amazon的控制台，是用javasript写的一个很复杂的网页程序，点击ec2，就到了ec2的管理首页。第一步是要建一个instance，点击select后让我选什么类型（没钱只能选micro），什么操作系统（选了它推荐的amazon自己的，另外还有redhat和suse），还要生成一个key，生成以后下载到了电脑上以备后用。然后一个instance就跑起来了！

**三、Putty连接**

想操作这个vps，还是得靠putty。这时还挺麻烦的，因为不像平常那样通过用户名和密码（用户名统一为ec2-user，根本没给密码），而是通过key来验证。这个key就是刚刚生成并下载下来的那个文件。

首先在putty目录下找到puttygen.exe这个程序，运行后点“load“，导入刚才下载的那个key文件。然后“Save private key“，将它保存为putty自己的格式才行。再运行putty，输入那个Public DNS和端口22，再到“Connection->SSH->Auth“里，指定那个生成的key文件。然后点“Open“，如果一切正确的话，就能连上了。

提示输入用户名，则输入ec2-user，这是统一的免费用户的用户名，不需要密码就成功登录了。

**四、root权限**

这时我运行yum update，提示我没有权限。输入su -，提示我输入密码。这怎么回事，难道没有root权限？

经过搜索，发现只是为了安全考虑，默认用户没有管理权限。但是它已经加入到了sudo列表，我们可以通过sudo来执行操作，比如：sudo yum update

如果你一定想变root，可以输入sudo su -，就变成root了

**五、下载jar**

运行了一下java和git，都已经装好了，看来这个安装版的确很周到。将github上的一个项目clone下来之后，运行sbt，开始下载jar了。速度很快，只花了一分钟左右全部jar都已经下好。下载play2.0的zip文件，每秒速度达到18M，这速度真给力。看来我以后再遇到下不了jar的情况，就到这台机器上操作了。

**六、试用Play2**

play2使用了scala，要知道这个可是吃内存的大户，不知道612M的内存够不够用。运行play run以后，程序启动了，监听9000端口。我在自己电脑上访问它，提示无法连接，猜测可能是防火墙问题。一搜索，果然ec2默认只开通了端口22。在管理员找到security group，加一条规则开放9000即可。

再次访问，可以打开，但是报错了！说是javac拿不到更多的内存，无法编译程序。这可是612M内存啊，连编译都不够用，太悲催了。还是Play1好，在256M的vps上，运行得很稳定。

**七、通过FileZilla下载jar**

刚才运行sbt时在vps上下载了不少jar，怎么拿回来？使用FileZilla，只看到了使用密码登录，一尝试果然不行。经过搜索，发现FileZilla也支持密钥，具体做法跟putty差不多，在settings里有一个选项，要求指定key。我把刚才putty生成的密钥文件设上去，再连接OK~

找了一个文件下载，速度相当不错，差不多400K/s。不过这是在晚上快12点时测的，繁忙时间不知道会怎么样。

**总结**：这个ec2感觉不错的，我非常满意，因为我用它主要是为了解决开发中jar下载麻烦的问题，都完美解决。以后有机再琢磨一下，怎么在它上面装个vpn，这样又能省下买vpn的钱了：）

可惜啊，只有一年的免费。
